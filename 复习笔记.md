> <font color=#FF0000>红色</font>表示考过；<font color=#0000FF>蓝色</font>表示考过，但是不确定是否是这个答案或者答案来自于奔腾
>
> 包含了往年题中的绝大多数知识点和题，没有的就是实在没找到答案或者不咋会做不想做了
>
> 包含了往年题中的绝大多数知识点，而不是课程中的，因为是按照题去整理的，不是按照PPT整理的

[toc]

# 基础知识

 <img src="复习笔记.assets/截屏2021-11-22 下午8.28.42.png" alt="截屏2021-11-22 下午8.28.42" style="zoom:50%;" />

> 这是2006年A卷选择前4道，为网络的基础知识，实验课PPT基本没讲

## H3C S5000P系列交换机

支持 Web管理的二层线速以太网交换产品，高性能且易于安装。 

定位：<font color=#FF0000>企业网和城域网桌面接入级的千兆交换机。</font>

 <img src="复习笔记.assets/截屏2021-11-22 下午5.20.49.png" alt="截屏2021-11-22 下午5.20.49" style="zoom:50%;" />

> 错在汇接层，应该在接入层。分级网络设计模型的三层在后面有

端口：全GE (Gigabit Ethernet，千兆以太网)端口

接口类型：1000BASE-LX、1000BASE-SX、1000BASE-T、 1000BASE-ZX 等

转发模式：存储转发

<font color=#FF0000>交换机是网络互连的重要设备之一，使用它可以有效地避免冲突的产生。由于交换机连接的每个网段都是一个独立的冲突域(collision domain)，因此可以通过增加网段数， 减少每个网段的用户数量，来减少冲突的产生。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.15.12.png" alt="截屏2021-11-21 下午7.15.12" style="zoom:50%;" />

<font color=#0000FF>H3C5000P系列交换机支持Console、Telnet、Web三种配置方式</font>（资料中没有，来源于2008级A卷判断第一题，下面对三种方式的具体描述来自2009级A卷简答第四题，操作步骤来源于PPT和个人的总结，操作步骤考过简答）



|   配置方式    |                   连接线类型以及连接的端口                   |                           操作步骤                           |
| :-----------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| Console口配置 | <font color=#0000FF>使用配置电缆连接交换机Console口和主机的RS232接口</font> | 创建超级终端；连接到交换机；根据实际需要对交换机进行相应的配置和管理 |
|  Telnet配置   | <font color=#0000FF>使用网线（双绞线）连接交换机的RJ45接口（电口）和主机的网卡RJ45接口</font> | 使用Console口登陆，配置交换机管理IP地址，配置Telnet登陆密码；在命令行下输入telnet命令；进行相应的配置 |
|    WEB配置    | <font color=#0000FF>使用网线（双绞线）连接交换机的RJ45接口（电口）和主机的网卡RJ45接口</font> | 运行Web浏览器，在地址栏中输入交换机的IP地址，回车；在显示的登录对话框中输入用户名和密码(admin/admin)，单击“确定”按钮或直接回车即可 进入Web网管初始界面。 |

SNMP(Simple Network Management Protocol，简单网络管理协议)是被广泛接受并投入使用的工业标准。它用于保证管理信息在任意两点间传送，便于网络管理员在网络上的任何节点检索信息、 修改信息、寻找故障、完成故障诊断、进行容量规划和生成报告。

<font color=#FF0000>S5000P系列交换机支持通过SNMP进行管理</font>



### 用户配置

<font color=#FF0000>从用户级别划分：S5000P有两种级别的用户，**参观级用户**和**管理级用户**。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.16.01.png" alt="截屏2021-11-21 下午7.16.01" style="zoom:50%;" />

从用户使用的登录接口来划分，可将用户分为三类: **CON用户**， CON用户是指通过串口接入的用户。 **AUX用户**，是指通过MODEM远程接入的用户。 **VTY用户**，是指通过TELNET接入的用户。

<font color=#FF0000>最多只能有**一个AUX**用户</font>

<font color=#FF0000>最多只能有**一个VTY**用户</font>

 <img src="复习笔记.assets/截屏2021-11-22 下午5.25.39.png" alt="截屏2021-11-22 下午5.25.39" style="zoom:50%;" />

> B支持多个VTY用户 错

<font color=#FF0000>S5000P 只支持一个 AUX 用户或者 VTY 用户在线。**AUX 用户优先级高于 VTY 用户**。当 AUX 用户 在线时，VTY 不能登录，只有等待 AUX 用户下线后，VTY 用户才能登录。当 VTY 用户在线时，如 果在串口上有任何操作，则 VTY 用户自动下线。</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午3.49.54.png" alt="截屏2021-11-20 下午3.49.54" style="zoom:50%;" />

<font color=#FF0000>在H3C S5000P交换机中配置用户分级密码的作用：用户进入系统视图时需要输入密码进行身份验证</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午3.49.32.png" alt="截屏2021-11-20 下午3.49.32" style="zoom:50%;" />

### 端口配置

#### 端口镜像

<font color=#FF0000>S5000P 提供基于端口的镜像功能，即可将指定的一个或多个端口的报文复制到镜像端口，用于报文的分析和监视。</font>（名词解释题）

<font color=#FF0000>在没有配置镜像端口时，配置被镜像端口不能成功。同时，在存在被镜像端口时，不能删除镜像端口。</font>

<font color=#FF0000>镜像端口和被镜像端口不能设置为同一个端口。</font>

当新的镜像端口配置后，原有的镜像端口被自动取消，被镜像端口没有变化。

<font color=#FF0000>设置镜像端口后，该端口自动配置为Trunk端口。删除镜像端口后，该端口自动配置为 Access 端口且加入 VLAN 1。</font>

S5000P只支持一个镜像组。

 <img src="复习笔记.assets/截屏2021-11-20 下午3.50.50.png" alt="截屏2021-11-20 下午3.50.50" style="zoom:50%;" />

<font color=#FF0000>S5000P 支持双向镜像，既同时对被镜像端口上的报文进行分析和监视。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午8.59.40.png" alt="截屏2021-11-21 下午8.59.40" style="zoom:50%;" />

<font color=red>简答题：在进行端口镜像配置时需要注意哪些问题？</font>

答：需要注意的问题包括：

(1)在进行端口镜像配置时，必须先配置镜像端口 (monitor port)，而且在被镜像端口(miroring port）未删除前，不能删除镜像端口。

(2)镜像端口和被镜像端口不能设置为同一个端口

(3)当新的镜像端口配置后，原有的镜像端口被自动取消，被镜像端口没有变化。

(4)设置镜像端口后，该端口自动配置为 Trunk 端口。删除镜像端口后，该端口自动配置为 Access 端口且加入 VLAN 1

(5)若端口己配置成为镜像端口，则不能对其进行端口汇聚的配置。

#### 端口汇聚

<font color=#FF0000>端口汇聚是将多个端口聚合在一起，以实现对出/入负荷在各成员端口中进行分担，增加带宽，且不形成环路</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午8.13.19.png" alt="截屏2021-11-21 下午8.13.19" style="zoom:50%;" />

支持整机最多 4 组(S5016P)，每组最多 16 个端口

支持整机最多 4 组(S5024P)，每组最多 24 个端口

<font color=#FF0000>在一个端口汇聚组中，所有成员端口的速率必须一致(10/100/1000Mbit/s)、必须工作在全双工状态、VLAN 端口类型必须一致(Access/Trunk)。</font>

若端口已配置成为镜像端口，则不能对其进行端口汇聚的配置。

 <img src="复习笔记.assets/截屏2021-11-21 上午9.41.40.png" alt="截屏2021-11-21 上午9.41.40" style="zoom:50%;" />

注：端口的三种工作方式：auto自协商状态、full全双工状态（ <font color=#FF0000>数据的发送和接收分流，分别由两根不同的传输线传送，通信双方都能在同一时刻进行发送和接收操作</font>）、half半双工状态（使用同一根传输线既作接收又作发送，虽然数据可以在两个方向上传送，但通信双方不能同时收发数据）

 <img src="复习笔记.assets/截屏2021-11-21 下午3.33.00.png" alt="截屏2021-11-21 下午3.33.00" style="zoom:50%;" />

<font color=red>当汇聚组中的端口出现故障时，数据可以从汇聚组中的其他端口进行转发。</font>





在配置端口汇聚之前，首先要保证参与汇聚的端口满足以下三个条件:

(1)必须工作在全双工方式下 (2)必须工作在相同的速率下 (3)端口的VLAN端口类型必须一致。

<font color=#FF0000>注意，参与端口汇聚的端口只能是连续的。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.20.04.png" alt="截屏2021-11-21 下午7.20.04" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午7.21.02.png" alt="截屏2021-11-21 下午7.21.02" style="zoom:50%;" />



#### 端口绑定

<font color=#FF0000>S5000P 支持 MAC 地址与端口绑定的功能，用户可以通过配置，只允许某些授权的设备通过该端口访问网络，而非授权设备不能通过该端口访问网络。</font>

<font color=#FF0000>端口绑定功能实现的基本原理: 将授权设备的 MAC 地址添加到该设备访问端口的静态 MAC 地址表项中，并取消该端口的 MAC 地址学习功能。这样只有目的 MAC 地址存在于静态地址表项中的报文才能被转发，从而实现端口绑定的功能。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午8.14.16.png" alt="截屏2021-11-21 下午8.14.16" style="zoom:50%;" />

> 基本原理考过简答

配置了端口汇聚的端口不能再配置端口绑定。

<font color=blue>如果一台主机的 MAC 地址已经与交换机的 G0/1 端口绑定，它是否可以通过 G0/2 端口连接交换机？为什么？</font>（奔腾2009级B卷简答第一题）

答案：如果 G0/2 端口己经和别的 MAC 地址进行绑定，则主机不能通过 G0/2 端口连接交换机。否则，主机可以通过 G0/2 端口连接交换机。因为未授权的 MAC 地址试图访问进行端口绑定的交换机端口时，交换机会挂起或禁用该端口。

#### 接口状态信息

交换机(和路由器)接口状态通常使用物理层状态和数据链 路层状态来表述，以交换机的G0/1端口为例，它可以包括以 下几种接口状态:

1. GigabitEthernet0/1 is up, line protocol is up 

2. GigabitEthernet0/1 is up, line protocol is down 

3. GigabitEthernet0/1 is administratively down, line protocol is down

4. GigabitEthernet0/1 is down, line protocol is down

逗号前表示的是物理层状态，逗号后表示的是数据链路状态，
<font color=#FF0000>这几种状态的含义是:</font>

1. <font color=#FF0000>表示端口处于正常状态，即G0/1端口被激活，可以正常工作。</font>
2. <font color=#FF0000>表示端口处于不正常状态，此状态多出现在路由器中。表示G0/1端口物理层正常但是数据链路层发生问题。数据链路 层出现问时可能的原因有:G0/1端口与对端接口的封装类 型不一致;没有配置时钟;接口上配置了no keep alive。</font>
3. <font color=#FF0000>表示端口处于不正常状态，问题的原因可能是G0/1端口被 管理员手工关闭，或者配置后没有被激活。</font>
4. <font color=#FF0000>表示端口处于不正常状态，问题的原因是接口发生物理损 坏，或者没有连接电缆。</font>

### VLAN

<font color=#FF0000>**VLAN (Virtual Local Area Network)**，即虚拟局域网，是一种通过将局域网内的设备逻辑地而不是 物理地划分成一个个网段，从而实现虚拟工作组的技术。</font>

> 名词解释题，最好下面的一段的也写上（答案上两段都有）

<font color=red>VLAN 技术允许网络管理者将一个物理的 LAN 逻辑地划分成不同的广播域(或称虚拟 LAN，即 VLAN)，每一个 VLAN 都包含一组有着相同需求的计算机工作站，与物理上形成的 LAN 有着相同的属性。但由于它是逻辑地而不是物理地划分，所以同一个 VLAN 内的各个工作站无须被放置在同 一个物理空间里，即这些工作站不一定属于同一个物理 LAN 网段。一个 VLAN 内部的广播和单播 流量都不会转发到其他 VLAN 中，有助于控制流量、减少设备投资、简化网络管理、提高网络的安全性。</font>

> 上面这段来自H3C S5000P操作手册，应该算是VLAN的作用，2006年考过简答题

<font color=#FF0000>同一个 VLAN 内的各个工作站不一定属于同一个物理 LAN 网段</font>

<font color=#0000FF>H3C 5000P系列交换机只能配置一个管理VLAN接口IP</font>（来自2008级A卷判断第2题）



#### 802.1q VLAN 

<font color=#0000FF>VLAN由IEEE 802.1q协议定义其帧格式，是最常用的一种VLAN，以下简称VLAN。在标准VLAN中一个端口(非Trunk类型)同时只能属于某一个VLAN。 不属于同一个VLAN的端口不能相互通信。</font>(不确定是否是802.1q VLAN的准确名词解释)



#### Port-based VLAN

<font color=#FF0000>Port-based VLAN 提供了用户分组的功能，用户通过配置可以隔离同一个 VLAN 内的不同用户，满 足了更丰富的组网需求。Port-based VLAN 可以通过创建不同的 user-group 来实现，一个端口可以属于多个 user-group。不 属于同一个 user-group 的端口不能相互通信。</font>

> 名词解释题

 <img src="复习笔记.assets/截屏2021-11-21 下午8.18.03.png" alt="截屏2021-11-21 下午8.18.03" style="zoom:50%;" />

#### 以太网端口链路类型

简答题，以太网端口的链路类型并简要说明区别（下面两段红字）

##### Access

<font color=red>Access类型的端口只能属于一个VLAN，一般用于连接计算机的端口;</font>

##### Trunk

<font color=#FF0000>Trunk(叫做干道或者中继)是一种封装技术，它是一条点到点的链路，链路的两端通常是交换机，或者是交换机和路由器。Trunk的主要功能是仅通过一条链路就可以连接多个 VLAN。Trunk也称为链路中继。</font>

> 名词解释题

Trunk类型的端口同样也只属于某一个VLAN，但是可以接收和发送来自多个VLAN的报文，一般用于交换机之间连接的端口。

#### VLAN切换

<font color=#FF0000>当VLAN为802.1q VLAN且处于缺省状态时，在VLAN 1视图下执行带有user-group的添加端口的操作，系统就会自动进入 Port-based VLAN 状态并给出提示。</font>

当VLAN为Port-based VLAN且处于缺省状态时，执行新增VLAN或者改变端口为Trunk类型的操作，系统就会自动进入 802.1q VLAN 状态并给出提示。

 <img src="复习笔记.assets/截屏2021-11-21 上午9.46.32.png" alt="截屏2021-11-21 上午9.46.32" style="zoom:50%;" />



802.1q VLAN的ID，取值范围为1~4094

Port-based VLAN:S5016P 最大可以设置 16 个 user-group，其 ID 取值范围为 1~16。S5024P 最大可以设置 24 个 user-group，其 ID 取值范围为 1~24。

<font color=#FF0000>最多支持 255 个符合 IEEE 802.1q 标准的 VLAN(Virtual Local Area Network， 虚拟局域网);最多支持 16 个(S5016P)/24 个(S5024P)基于端口的 VLAN(Port-based VLAN)</font>

<font color=#FF0000>802.1q VLAN 和 Port-based VLAN 在 S5000P 中不能同时启用。</font>

<font color=#FF0000>802.1q VLAN的缺省状态为只存在VLAN1，且所有端口为access端口。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.14.33.png" alt="截屏2021-11-21 下午7.14.33" style="zoom:50%;" />

<font color=blue>某企业进行网络升级，需要在原有的两台交换机之间增加两台交换机，现有的交换机上创建了 vlan2 和 vlan3，并且由数据帧通过它们发送和接收，那么新添加的两台交换机需要创建 vlan2 和vlan3吗？说明原因。</font>

（来自2009级B卷简答第二题）

答案：需要创建。因为如果不创建 vlan2 和vlan3，则新的交换机的端口都是属于 vlan1的，原有的两台交换机通过新增的交换机进行连接时，会造成原有交换机的 vlan2 和vlan3之间可以通过新增的交换机实现互联，破坏原有 vlan 的划分。

Port-based VLAN 的缺省状态为只有一个 VLAN 1 存在，且所有端口只属于 user-group 1。

Port-based VLAN 中，交换机的所有端口只属于 VLAN 1，但可以属于不同的 user-group。

 <img src="复习笔记.assets/截屏2021-11-20 下午4.00.09.png" alt="截屏2021-11-20 下午4.00.09" style="zoom:50%;" />

### 命令行

#### 命令行视图

##### 视图关系

 <img src="复习笔记.assets/截屏2021-11-21 上午9.08.25.png" alt="截屏2021-11-21 上午9.08.25" style="zoom:50%;" />

<font color=red>简答题，简要说明S5000P命令行接口下有哪些视图，并简要说明他们的功能特性</font>>

|      视图      |                         功能                          |            提示符            |                           进入命令                           |                   退出命令                    |
| :------------: | :---------------------------------------------------: | :--------------------------: | :----------------------------------------------------------: | :-------------------------------------------: |
|    用户视图    |  查看交换机的运行状态和统计信息，进行简单的系统管理   |          \<Quidway>          |                   与交换机建立连接即可进入                   |          **quit**:断开与 交换机连接           |
|    系统视图    |                     配置系统参数                      |          \[Quidway]          |               在用户视图下键入**system-view**                | **quit**:返回用户视图;**return**:返回用户视图 |
| 以太网端口视图 |                  配置以太网端口参数                   | [Quidway-GigabitEthernet0/1] |      在系统视图下键入 **interface GigabitEthernet0/1**       |                       ~                       |
|   VLAN 视图    |                    配置 VLAN 参数                     |       [Quidway-Vlan1]        |         在系统视图或以太网端口视 图下键入 **vlan 1**         |                       ~                       |
| VLAN 接口视图  | <font color=#FF0000>配置 VLAN 对应的IP接口参数</font> |  [Quidway-Vlan-interface1]   | 在系统视图、以太网端口视图或VLAN视图下键入**interface vlan-interface 1** |                       ~                       |
|  用户界面视图  |                   配置用户界面参数                    |       \[Quidway-Aux0]        |           在系统视图下键入**user-interface aux 0**           |                       ~                       |
|  用户界面视图  |                   配置用户界面参数                    |       \[Quidway-vty0]        |           在系统视图下键入**user-interface vty 0**           |                      ～                       |

 <img src="复习笔记.assets/截屏2021-11-21 上午9.31.33.png" alt="截屏2021-11-21 上午9.31.33" style="zoom:50%;" />



### 交换机功能

注：交换机的主要功能就是：地址学习、转发/过滤和消除环路。对每个名词的简述用<font color=purple>紫色</font>标出。

#### 地址学习

<font color=#FF0000>MAC地址表：S5000P 维护着一张用于报文转发的地址表。这张表的表项包含了设备的地址及与此设备相连的交 换机端口号。对于目的地址能够在地址表中查到的报文，以太网交换机直接采用硬件转发方式处理; 对于目的地址不能在地址表中查到的报文，以太网交换机采用广播方式处理。</font>

> 名词解释

<font color=#FF0000>地址学习：</font>

> 名词解释

- <font color=purple>交换机收到帧后将发送方的MAC地址(即源MAC地址)和接收接口对应起来**添加到MAC地址表中**，并通过泛洪将数据帧**转发**出去，网段上的其他主机接收到这个帧后，只有**真正的接收方发出响应**，**其余的主机将此帧丢弃**。**接收方的响应帧**返回到交换机后，它的目的MAC地址为发送方的MAC地址，此时发送方的MAC地址和它与交换机相连的接口号已经被保存在交换机的MAC地址表中，交换机则按MAC地址表中相应条目进行数据帧的转发，同时，**将接收方响应帧中的源地址(即接收方的MAC地址)和接收接口 对应起来添加到MAC地址表中**。随着网络中的主机不断发送帧，这个学习过程也将不断进行下去，**最终，交换机获得了一份完整的MAC地址表**。</font>
- 如果发现**从特定接口接收到的源MAC地址发生了改变**，交 换机会**用新的MAC地址替换**MAC地址表中已经存在的与该接口对应的MAC地址。
- MAC地址表中**的条目是有生命周期的**，在一定时间内交换机没有从特定接口接收到在MAC地址表中记录的与此接口对应的MAC地址发出的数据帧，交换机会认为该主机已经 不再与该接口相连，于是删除MAC地址表中对应的条目。

#### 转发/过滤

<font color=purple>交换机发现接收到的帧的目的MAC地址已经保存在其MAC 地址表中，则只对MAC地址表中该地址对应的接口转发数据帧。当交换机发现帧中的目的地址为广播地址和组播地址时， 交换机将此帧从除了入口外的所有接口转发出去。</font>

交换机根据MAC地址表来转发数据帧，我们把交换机在接口间传递帧的方式称为转发模式或交换模式，主要的转发模式包括:

##### 直通转发

直通转发(Cut Through)是指交换机收到帧头(通常只检查14个字节)后立刻获取目的MAC地址进行转发。

优点：极大地减少了延迟、加快了交换速度，因此也被称为快速转发。

快速转发的延迟是固定的，与帧长无关。

缺点：<font color=#FF0000> 不提供错误检测能力</font>，无法检查所传送的帧是否有误。<font color=#FF0000>当输入、输出接口速率不同时，不能简单地使用这种模式。</font>

##### 存储转发

存储转发(Store and Forward)模式下，交换机要收到完整的帧后再读取目的MAC地址进行转发，并<font color=#FF0000>进行循环冗余校验，丢弃错误的帧</font>。

<font color=#FF0000>支持不同速率接口的交换机必须使用存储转发模式，它通过缓存来保证高速接口和低速接口的正确通信。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午12.33.23.png" alt="截屏2021-11-21 下午12.33.23" style="zoom:50%;" />



<font color=#FF0000>缺点是延时较大。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午9.00.45.png" alt="截屏2021-11-21 下午9.00.45" style="zoom:50%;" />

##### 无碎片转发

无碎片直通转发，又称为分段过滤、碎片隔离。这种转发方式介于前两种之间。

交换机读取前64个字节后开始转发。 由于冲突一般发生在前64个字节之内，通过读取前64个字节，交换机能过滤掉由冲突产生的帧碎片。无碎片直通转发的数据处理速度比存储转发方式快，但比直通转发慢。 <font color=#FF0000>它不提供数据校验</font>。

无碎片直通转发的缓存采用先进先出(FIFO)的方式工作， 即帧按序从一端进入，再按照同样的顺序从另一端输出。 当帧被接收时，它被保存在FIFO缓存中，如果帧长小于 512位，则FIFO中的内容(碎片)会被丢弃，因此解决了 直通转发中的碎片转发问题。

 <img src="复习笔记.assets/截屏2021-11-21 上午9.33.05.png" alt="截屏2021-11-21 上午9.33.05" style="zoom:50%;" />

#### 消除环路

<font color=purple>在数据链路层上，相同源端和目的端的多条路径被称为环路，以太网交换机通过生成树协议避免环路，同时允许存 在多条备用路径。</font>

#### 交换机在分级网络设计模型中的应用

 <font color=#FF0000>在组建大、中型局域网过程中，经常使用分级网络设计模 型进行网络设计。将网络分为接入层、汇聚层和核心层。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午12.39.48.png" alt="截屏2021-11-21 下午12.39.48" style="zoom:50%;" />

接入层，直接面向用户连接，允许终端用户连接到网络的部分。因此接入层交换机具有低成本和高端口密度特性。

汇聚层，位于接入层和核心层之间的部分。与接入层交换机比较，需要更高的性能，更少的接口和更高的交换速率。

核心层，网络主干部分，通过高速转发通信，提供优化， 可靠的骨干传输结构，因此核心层交换机应拥有更高的可靠性，性能和吞吐量。

第二层交换机用于网络接入层和汇聚层。

基于IP地址和协议进行交换的第三层交换机普遍应用于网络的核心层，也少量应用于汇聚层。

有些第三层交换机同时具有第四层交换机的部分功能，可以根据数据帧的协议端口信息进行目标端口判断。

第四层以上的交换机称之为内容型交换机，主要用于互联网数据中心。

目前三层交换机和多层交换机在网络中已经大量使用。简单来说，三层交换机就是把交换机的性能与路由器的路由功能结合起来，目前应用已十分广泛，使用效果也很突出。



### H3C S5016P

端口：16个10/100/1000BASE-T自适应以太网端口

Combo SFP接口：4个 Combo SFP光模块接口

### H3C S5024P

端口：24个10/100/1000BASE-T自适应以太网端口和

<font color=#FF0000>Combo SFP接口：4个Combo SFP光模块接口</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午3.48.42.png" alt="截屏2021-11-20 下午3.48.42" style="zoom:50%;" />

> 个人感觉选B，Combo类型的意思是光电复用

## 路由、路由器及路由协议

### 概念及基本组成

<font color=#FF0000>路由器 - 工作在 OSI 参考模型第三层的网络设备</font>；用于网络互连的设备

作为路由器，必须具备:1. 两个或两个以上的接口；2.协议至少向上实现到网络层 à 具有存储、转发、寻径功能

### 路由器的作用

<font color=red>路由器的核心作用是实现网络互连</font>



- 分组数据转发

- 路由(寻径):路由表建立、刷新、查找

- <font color=#FF0000>子网间的速率适配</font>

- <font color=#FF0000>隔离网络，防止网络风暴，制定访问规则(防火墙) </font>

   <img src="复习笔记.assets/截屏2021-11-21 下午12.36.29.png" alt="截屏2021-11-21 下午12.36.29" style="zoom: 50%;" />

- <font color=#FF0000>异种网络互连</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午4.34.47.png" alt="截屏2021-11-20 下午4.34.47" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午7.12.18.png" alt="截屏2021-11-21 下午7.12.18" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午8.23.04.png" alt="截屏2021-11-21 下午8.23.04" style="zoom:50%;" />答案C

-------------------

 <img src="复习笔记.assets/截屏2021-11-22 下午5.00.04.png" alt="截屏2021-11-22 下午5.00.04" style="zoom:50%;" />

> 答案为AC，来源于[网络](https://wenku.baidu.com/view/3662142a3169a4517723a33b.html)

### H3C AR28-31路由器

<font color=red>根据网络规模的不同，AR28系列路由器既可以在中小型企业网中担当核心路由器，也可以在大的企业中担当分支网络的接入路由器，同时适合在电信管理网、 计费网等电信级网络中应用。</font>

 <img src="复习笔记.assets/截屏2021-11-22 下午8.24.50.png" alt="截屏2021-11-22 下午8.24.50" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-22 下午8.25.07.png" alt="截屏2021-11-22 下午8.25.07" style="zoom:50%;" />

#### 用户管理

##### 用户界面

 <img src="复习笔记.assets/截屏2021-11-20 下午4.56.58.png" alt="截屏2021-11-20 下午4.56.58" style="zoom: 23%;" />

##### 用户

以用户获得的服务 划分，可以将路由器的用户划分为:

- Terminal用户，通过Console口或AUX口、异步口登录到路由器; 
- Telnet用户，使用Telnet命令登录到路由器;
-  FTP用户，与路由器建立FTP 连接进行文件传输;
- PPP用户，与路由器建立PPP 连接，从而访问网络;
- SSH用户，与路由器建立SSH 连接，登录到路由器;
- PAD用户，与路由器建立PAD 连接，从而访问网络。

一个用户可能同时获得几种服务。

##### 认证方式

不认证、password认证、本地认证（用户名和口令与路由器上的一致）、 AAA服务器认证（用户名和口令与AAA 服务器上的一致）。

##### 用户优先级

<font color=#FF0000>分为参观(**Visit**)、监控(**Monitor**)、系统(**System**)、管理 (**Manage**)**4** 个级别，级别标识为**0**~**3**。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.21.56.png" alt="截屏2021-11-21 下午7.21.56" style="zoom:50%;" />

<font color=#FF0000>用户所能访问的命令包括用户级别的命令以及低于用户级别的命令。</font>

缺省情况下，CON口用户界面对应的默认命令访问级别是3，而其它用户接口对应的默认级别是0。

如果用户界面下配置的命令级别访问权限与用户名本身对应的操作权限冲突，则以用户名本身对应的级别为准。

如果配置的认证方式为不认证或采用password认证，则用户登录到系统后所能访问的命令级别由**用户界面**的优先级确定。

<font color=#FF0000>如果配置的认证方式需要用户名和口令，则用户 登录系统后所能访问的命令级别由**用户**的优先级确定。</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午5.08.54.png" alt="截屏2021-11-20 下午5.08.54" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-20 下午5.09.11.png" alt="截屏2021-11-20 下午5.09.11" style="zoom:50%;" />

-----------------------------

 <img src="复习笔记.assets/截屏2021-11-21 下午12.15.02.png" alt="截屏2021-11-21 下午12.15.02" style="zoom:50%;" />

---------------------------

 <img src="复习笔记.assets/截屏2021-11-21 下午7.23.35.png" alt="截屏2021-11-21 下午7.23.35" style="zoom:50%;" />

#### <font color=red>路由器接口</font>

（考过让画整个图（不包括那个黄色气泡））

 <img src="复习笔记.assets/截屏2021-11-20 下午11.14.25.png" alt="截屏2021-11-20 下午11.14.25" style="zoom:23%;" />

<font color=#FF0000>路由器逻辑接口举例及其作用（简答题）：</font>

Loopback接口：<font color=#FF0000>Loopback接口属于逻辑接口，逻辑接口指能够实现数据交换功能但物理上不存在、需要通过配置建立的接口。TCP/IP协议规定，127.0.0.0网段的地址属于环回地址。包含这类地址的接口属于环回接口。在H3C系列路由器上，**定义了接口Loopback0为环回接口，环回接口可以用来接收所有发送给本机的数据包**。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午7.25.33.png" alt="截屏2021-11-21 下午7.25.33" style="zoom:50%;" />

Null接口：<font color=#FF0000>Null接口永远处于Up状态，但不能转发数据包，也不能配置IP地址或配置其它链路层协议。**Null接口是一种纯软件性质的逻辑接口。任何送到该接口的网络数据报文都会被丢弃**。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午3.52.29.png" alt="截屏2021-11-21 下午3.52.29" style="zoom:50%;" />

#### 同步串口

#### 异步串口

两种异步串口:异步串口分为设置成**异步方式的同/异步串口**（Serial）和**专用异步串口**（Async）

异步串口可以设为专线方式和拨号方式，常用的是拨号方式

异步串口的链路建立方式：

- 协议模式
  - 协议模式指Serial接口的物理连接建立之后，接口直接采用已有的链路层协议配置参数，然后建立链路。
  - 协议模式下，链路层协议类型为PPP协议。
  - 协议模式下，支持IP网络层协议。
- 流模式
  - 流模式是指Serial接口两端的设备进入交互阶段后，链路一端的设备可以向对端设备发送配置信息，设置对端设备的物理层参数，然后建立链路。
  - 流模式下，不支持链路层协议，也不支持IP网络层协议。

> 以上两种方式来自[网络](https://forum.huawei.com/enterprise/zh/thread-225029-1-1.html)

- <font color=#0000FF>终端模式</font>（没有找到相关资料，奔腾2009级B卷选择第九题（下图）是这么给的答案）

 <img src="复习笔记.assets/截屏2021-11-21 下午4.18.59.png" alt="截屏2021-11-21 下午4.18.59" style="zoom:50%;" />

#### 控制端口和辅助端口

控制端口和辅助端口的一个主要的优点是都允许路由器的带外管理。

|                             特点                             | 控制端口 | 辅助端口 |
| :----------------------------------------------------------: | :------: | :------: |
|               使用短的电缆，需要终端接近路由器               |    Y     |    N     |
| <font color=#FF0000>需要借助**Modem**和**PSTN**进行远程访问</font> |    N     |    Y     |
|                 路由器发送错误消息到这个端口                 |    Y     |    N     |
|                 可以在这个端口上执行口令恢复                 |    Y     |    N     |
|                 发送路由器启动消息到这个端口                 |    Y     |    N     |

控制端口即Console口，辅助端口即AUX口（Auxiliary port）

 <img src="复习笔记.assets/截屏2021-11-21 上午10.00.00.png" alt="截屏2021-11-21 上午10.00.00" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-21 上午10.02.28.png" alt="截屏2021-11-21 上午10.02.28" style="zoom:50%;" />

以太网接口：用于网络连接

LoopBack接口：路由器的一种逻辑接口

### 路由

**路由选择协议**:这类协议使用一定的消息、规则和路由算法找出到达目的主机或网络的最佳路径， 简称路由协议。如RIP协议等。每台路由器为每 个子网选择最佳路由(路径选择)并将最佳路由放入IP路由表中。<font color=#FF0000>路由选择协议位于网络层</font>。

 <img src="复习笔记.assets/截屏2021-11-21 下午3.57.55.png" alt="截屏2021-11-21 下午3.57.55" style="zoom:50%;" />

<font color=#FF0000>路由权(cost)表示到达这条路由所指的目的地址的代价</font>，通常以下因素会影响到路由的权值：线路延迟、带宽、线路占有率、线路可信度、跳数、最大传输单元

<font color=#FF0000>路由收敛:是指拓扑变化的过程。具体的讲，当发生了一些事件，如一台路由器或一条链路失效，网络中的最佳路由可能会变化，将这个变化的信息通告给其他路由器，并重新选择每个子网的最佳路由，最后全网路由再恢复稳定的过程。</font>

衡量一种路由协议最重要的指标:不引起环路， 快速收敛。
收敛的其他定义: 

- 当网络中所有路由器具有一致的网络知识，此时的网络被称为收敛完成。 
- 路由协议必须认识到网络拓扑的变化，并确保所有的路由器知道这个变化以使网络收敛。

#### 路由分类

- 根据路由的目的地不同，可以划分为:
  - 子网路由:目的地为子网
  - 主机路由:目的地为主机
- 根据目的地与该路由器是否直接相连，又可分为: 
  - 直接路由:目的地所在网络与路由器直接相连
  - 间接路由:目的地所在网络与路由器不是直接相连



#### 直连路由

直接连到路由器接口的子网被称为直连子网。路由器自动地将他们的路由加入路由表，被称为直连路由。

<font color=#FF0000>是链路层协议发现的路由</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午5.17.17.png" alt="截屏2021-11-20 下午5.17.17" style="zoom:50%;" />

特点：开销小，配置简单，无需人工维护。只能发现本接口所属网段的路由。

#### 路由表

<font color=#FF0000>路由器转发分组的关键是路由表。每个路由器中都保存着一张路由表，表中每条路由项都指明分组到某子网或某主机应通过路由器的哪个物理端口发送，然后就可到达该路径的下一个路由器， 或者不再经过别的路由器而传送到直接相连的网络中的目的主机。</font>

> 名词解释题

<font color=#FF0000>路由表包含的关键项：</font>（来自PPT）

- 目的地址:用来标识IP 包的目的地址或目的网络。
- 网络掩码:与目的地址一起来标识目的主机或路由器所在的网段的地址。将目的地址和网络掩码“逻辑与”后可得到目的主机或路由器所在网段的地址。例如: 目的地址为129.102.8.10，掩码为255.255.0.0 的主机或路由器所在网段的地址 为129.102.0.0。掩码由若干个连续“1”构成，既可以以点分十进制表示，也可 以用掩码中连续“1”的个数来表示。
- 输出接口:说明IP包将从该路由器哪个接口转发。
- 下一跳IP地址:说明IP包所经由的下一个路由器。
- 优先级：本条路由加入IP 路由表的优先级:针对同一目的地，可能存在不同下一跳的若
  干条路由，这些不同的路由可能是由不同的路由协议发现的，也可以是手工配置的静态路由。优先级最高(数值最小)的一条将成为当前的最优路由。
- 获取方式：协议的来源，即该路由通过哪种路由协议获取

<font color=#FF0000>路由表包含的关键项：</font>（来自奔腾2021级简答第四题的答案，使用<font color=orange>橙色</font>标注了PPT上没有写的）

答：（给出下面7个中任意5个即可)
(1)目的地址：用来标识IP包的目的地址或目的网络。

(2)网络掩码：与目的地址一起来标识目的主机或路由器所在的网段的地址。

(3)协议：指明了路由的来源，即路由是如何生成的。

(4)优先级：各路由协议(包括静态路由〉都被赋予了一个优先级，这样，当存在多个路由信息源时，具有较高优先级 (数值越小表明优先级越高）的路由协议发现的路由将成为最优路由，并被加入路由表中。

<font color=orange>(5)开销：标识出了到达这条路由所指的目的地址的代价。</font>

(6)输出接口：说明IP包将从该路由器哪个接口转发。

(7)下一跳IP 地址：说明IP包所经由的下一个路由器。

<font color=#0000FF>RIP和OSPF各自得到了一条到达目标网络的路由信息，在华为路由器默认情况下，网络最终选择OSPF路由为最佳路由。</font>

 <img src="复习笔记.assets/截屏2021-11-22 下午12.13.17.png" alt="截屏2021-11-22 下午12.13.17" style="zoom:50%;" />

上面这句话没找到出处，是2008级A卷选择第八题的答案。但是从[网上](https://blog.csdn.net/qq_35440375/article/details/53321990)找到了以下内容：

华为路由器规定的路由协议优先级为：

|        协议        | 优先级 |
| :----------------: | :----: |
| DIRECT（直连路由） |   0    |
|        OSPF        |   10   |
|       STATIC       |   60   |
|        IGRP        |   80   |
|        RIP         |  1101  |
|      OSPFASE       |  150   |
|        BGP         |  170   |

因此，结合上面路由项中优先级的定义，数值越小优先级越高，因此在华为路由器中，OSPF优先级高于RIP

#### 静态路由

静态路由是一种特殊的路由，它由管理员手工配置而成。通过静态路由的配置可建立一个互通的网络

<font color=red>缺点：当一个网络故障发生后，静态路由不会自动发生改变，必须有管理员的介入。</font>

特点：开销，配置简单，需人工维护，适合简单拓扑结构的网络。对于不同的静态路由，可以为它们配置不同的优先级，从而更灵活地应用路由管理策略。例如:配置到达相同目的地的多条路由，如果指定相同优先级，则可实现负 载分担，<font color=blue>如果指定不同优先级，则可实现路由备份。</font>(来自H3C S9500 系列路由交换机 操作手册 589页)

 <img src="复习笔记.assets/截屏2021-11-22 下午4.39.37.png" alt="截屏2021-11-22 下午4.39.37" style="zoom:50%;" />

> 应该是ABCD，答案来源，[华为HCSE认证设计知识点总结](https://www.diyifanwen.com/kaoshizhuanti/3COMrenzheng/0761622291146489_28.htm)

<font color=red>以下关于静态路由特点的说法中正确的有：在大型网络中配置复杂、可以用于路由备份、可以用于隔离各个大型区域、通信网络带宽无开销</font>

#### 缺省路由

<font color=#FF0000>缺省路由是一种特殊的路由，可以通过静态路由配置，某些动态路由协议也可以生成缺省路由。 简单地说，缺省路由就是在没有找到匹配的路由 时才使用的路由**,**即只有当没有合适的路由时，缺省路由才被使用。</font>

> 名词解释题、判断题

 <img src="复习笔记.assets/截屏2021-11-21 下午10.45.33.png" alt="截屏2021-11-21 下午10.45.33" style="zoom:50%;" />这是错的，也可以由某些动态路由协议生成

<font color=#FF0000>为了不使路由表过于庞大，可以设置一条缺省路由</font>。凡遇到查找路由表失败后的数据包，就选择 缺省路由转发。

 <img src="复习笔记.assets/截屏2021-11-22 下午8.22.29.png" alt="截屏2021-11-22 下午8.22.29" style="zoom:50%;" />



#### 动态路由

是动态路由协议发现的路由

特点：开销大，配置复杂，无需人工维护，适合复杂拓扑结构的网络

<font color=#FF0000>简述路由的来源以及特点</font>（2021年B卷简答第三题）

答案：来源主要有三种：直连路由、静态路由和动态路由。（具体的特点见上面，答案里没有缺省路由应该是因为缺省路由包含在了静态和动态中）

### 动态路由协议

<font color=#FF0000>衡量路由协议的性能指标：</font>

> 简答题

- 正确性 能够正确找到最优的路由，且无自环。
- 快收敛 当网络的拓扑结构发生变化之后，能够迅速在自治系统中作相应的路由改变。
- 低开销 协议自身的开销(内存、CPU、网络带宽)最小。
- 安全性 协议自身不易受攻击，有安全机制。
- 普适性 适应各种拓扑结构和规模的网络。

<font color=#FF0000>按寻径算法划分，动态路由协议划分为几类，每类的工作方式：</font>

- 距离矢量算法(贝尔曼**-**福特算法)

  - **工作方式**：<font color=red>路由器定期广播自己的路由表**,**在广播报文中包括了路由器了解的网络以及到每个网络的距离(比如用跳数来衡量).收到报文的路由器将此信息和自己当前路由表相比较**,**从中计算出一张新的路由表**.**</font>

     <img src="复习笔记.assets/截屏2021-11-22 下午3.33.50.png" alt="截屏2021-11-22 下午3.33.50" style="zoom:50%;" />

    > 2008-2009学年第二学期B卷填空第七题，无答案，感觉应该填“距离矢量”或“距离矢量算法”

  - 协议：

    - RIP协议（内部）
    - BGP协议（外部）

- 链路状态算法

  - **工作方式**：<font color=#0000FF>采用链路状态路由协议的路由器不是交换到达目的地的距离，而是维护一张用数据库表示的网络拓扑结构图，其中的每个表项对应网络的一条链路。路由器根据数据库的信息计算出“最佳路由”，由此指导包的转发</font>。(不确定工作方式是不是这个)

  - 协议：<font color=#FF0000> 链路状态路由协议是为路由域中每个节点链路分配一个度量值,**每个路由器都通过链路状态公告 (LSA)将自己的链路度量值告诉给它的相邻节点**。LSA 中包含的链路度量值可能是一个或多个。 各结点间的路径选择的标准就是使该路径的所有链路的度量值最小。链路状态方案中的每一个路由器都使用着同一个数据库的拷贝。</font>（简答题、填空题，链路状态协议的定义）

     <img src="复习笔记.assets/截屏2021-11-21 下午8.20.16.png" alt="截屏2021-11-21 下午8.20.16" style="zoom:50%;" />

    - OSPF协议（内部）
    - IS-IS协议（内部）

**自治系统(AS)**: 是由同一机构管理，使用同一组选路策略的路由器的集合。自治系统又叫做路由域，能被逻辑 地划分为多个区域。在每个自治系统中，必须定义一个连 续的骨干区域，所有非骨干区域必须与骨干区域相连。骨 干区域是一个传递区域，因为其他区域都要通过它进行通信。

**自治系统编号(ASN)**:每个自治系统被分配一个编号， 称为自治系统号。

**内部网关协议(IGP)**:设计应用于一个AS内部的协议，被称为 IGP。

**外部网关协议(EGP)**:设计应用于不同自治系统之间的 路由协议。即，用于在不同的自治系统之间的路由器交换路由信息，被称为EGP。

 <img src="复习笔记.assets/截屏2021-11-22 下午4.17.20.png" alt="截屏2021-11-22 下午4.17.20" style="zoom:50%;" />

> BGP是外部路由协议，RIP、OSPF和ISIS都是内部路由协议

 <img src="复习笔记.assets/截屏2021-11-22 下午8.21.49.png" alt="截屏2021-11-22 下午8.21.49" style="zoom:50%;" />

#### RIP协议

<font color=#FF0000>路由信息协议(Routing Information Protocol， RIP)是一种较为简单的内部网关协议(Interior Gateway Protocol，IGP)，主要用于规模较小的网络。</font>

 <img src="复习笔记.assets/截屏2021-11-21 上午11.49.59.png" alt="截屏2021-11-21 上午11.49.59" style="zoom:50%;" />

由于RIP的实现较为简单，协议本身的开销对网络的性能影响比较小，并且在配置和维 护管理方面也比OSPF或IS-IS 容易，因此在实际组网中仍有广泛的应用。

- <font color=#FF0000>路由权值取值范围为0~16，</font><font color=#0000FF>缺省为1</font>，<font color=#FF0000>15是最大的有效路由权值，16为无穷大</font>

 <img src="复习笔记.assets/截屏2021-11-21 上午11.49.34.png" alt="截屏2021-11-21 上午11.49.34" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午12.37.20.png" alt="截屏2021-11-21 下午12.37.20" style="zoom:50%;" />

- <font color=#FF0000>默认30s更新周期</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午3.50.35.png" alt="截屏2021-11-21 下午3.50.35" style="zoom:50%;" />

- 当路由变化时，部分触发更新

- 使用路由毒化、毒性反转、水平分割及抑制：

  - 路由毒化：

    - 路由毒化是路由广播的一个实例，但是它的度量值是特殊的，被叫做无穷大。路由器认为度量值为无穷大的路由广播代表失效。
    - 每种距离矢量路由协议都使用一个明确的度量值 来表示无穷大。<font color=#FF0000>RIP定义的无穷大为16</font>。
    - 距离矢量路由协议使用毒化路由的方法传播关于路由失效的坏消息。

     <img src="复习笔记.assets/截屏2021-11-21 下午7.28.03.png" alt="截屏2021-11-21 下午7.28.03" style="zoom:50%;" />

    > 度量值即路由权值（应该是这样）

  - 毒性反转：当学到一条失效路由时，对这条路由忽略水平分割规则，并通告毒化路由

  - 水平分割：从接口X发出的路由更新中，不能包括那些出 口也为X的路由信息;
  - 触发更新：当路由失效时，不再等待下一个更新周期，而是立即触发，发布毒化路由更新
  - 抑制：当某条路由被认为失效后，路由器会让这条路由保持down状态一段时间，以确保每台路由器都学到这个信息。抑制过程会让路由器忽略掉有关这条失效路由的新信息，这段时间称为抑制时间，利用抑制计时器计时。即: 当收到一条毒化路由时，为这条路由启动抑制计时器。在抑制时间内，这条失效路由不接收任何信息，除非这条信息是从原始通过这条路由的路由器来的。

**rip input** 用来允许接口接收RIP报文。<font color=#FF0000>缺省情况下，除 loopback 接口之外的所有接口接收RIP报文。</font>

#### OSPF协议

<font color=#FF0000>**OSPF** ：**Open Shortest Path First**(开放最短路由优先协议)，是一个基于链路状态的内部网关协议。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午4.22.12.png" alt="截屏2021-11-21 下午4.22.12" style="zoom:50%;" />

##### 一些名词

**DR**(**Designated Router**，指定路由器)：在广播网络或者多点访问网络中，为使每台路由器能将本地状态信息广播到整个 自治系统中，在路由器之间要建立多个邻居关系，但这使得任何一台路由器的路由变化都会导致多次传递，浪费了宝贵的带宽资源。为解决这一问题，OSPF协议定义了DR，所有路由器都只将信息发送给DR，由DR将网络链路状态广播出去，除 DR/BDR外的路由器(称为DR Other)之间将不再建立邻居关系，也不再交换任何路由信息。哪一台路由器会成为本网段内的DR并不是人为指定的，而是由本网段中所有的路由器共同选举出来的。

**BDR**(**Backup Designated Router**，备份指定路由器))：如 果DR由于某种故障而失效，这时必须重新选举DR，并与之同步。这需要较长的时间，在这段时间内，路由计算是不正确的。 为了能够缩短这个过程，OSPF提出了BDR的概念。<font color=#FF0000>BDR实际上是对DR的一个备份，在选举DR的同时也选举出BDR，BDR 也和本网段内的所有路由器建立邻接关系并交换路由信息。当 DR失效后，BDR会立即成为DR，并重新选举BDR。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午9.11.30.png" alt="截屏2021-11-21 下午9.11.30" style="zoom:50%;" />

区域边界路由器 (**Area Border Router**，简称为**ABR**

自治系统边界路由器(**Autonomous System Boundary Router**，简称为**ASBR**)

路由域 (**routing domain**)



##### 区域（Area）

<font color=#FF0000>一台路由器可能同时属于不同的区域(这样的路由器称作**ABR**)，但一个网段只能属于一个区域。</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午7.58.33.png" alt="截屏2021-11-20 下午7.58.33" style="zoom:50%;" />

OSPF协议可以将自治系统划分成多个区域(Area)，区域在逻辑上将路由器划分为不同的组。

不 同的区域以**区域号(Area ID)**标识，<font color=#FF0000>其中一个最重要的区域是区域0，也称为骨干区域(backbone area)</font>。通 过骨干区域可以完成非骨干区域之间的路由信息交换，它必须是连续的，<font color=red>对于物理上不连续的区域，需要配置**虚连接**(virtual links)来保持骨干区域在逻辑上的连续性。</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午8.21.48.png" alt="截屏2021-11-21 下午8.21.48" style="zoom:50%;" />

 <img src="复习笔记.assets/截屏2021-11-22 下午3.37.05.png" alt="截屏2021-11-22 下午3.37.05" style="zoom:50%;" />

##### Router ID

Router ID：一台路由器如果要运行OSPF协议，必须存在Router ID。

路由器的ID可以手工配置。如果没有配置ID号：

- 若系统当前配置了Loopback 接口IP地址，则选择最后配置的Loopback 接口的IP地址作为router id;
- 若系统当前没有配置Loopback 接口，则选取第一个配置并UP的物理接口的IP地址作为router id。

UP是一种接口状态，与之相对的是DOWN

 <img src="复习笔记.assets/截屏2021-11-21 上午10.22.21.png" alt="截屏2021-11-21 上午10.22.21" style="zoom:50%;" />

##### OSPF

如果在启动OSPF 时不指定进程号，将使用缺省的进程号1;<font color=#FF0000>关闭OSPF 时不指定进程号，缺省关闭进程1</font>。

<font color=#FF0000>在同一个区域中的进程号必须一致，否则会造成进程之间的隔离</font>

<font color=#FF0000>OSPF支持多进程，一台路由器上启动的多个OSPF进程之间由不同的进程号区分。OSPF 进程号在启动OSPF时进行设置，它只在本地有效，不影响与其它路由器之间的报文交换。</font>

 <img src="复习笔记.assets/截屏2021-11-20 下午8.41.51.png" alt="截屏2021-11-20 下午8.41.51" style="zoom:50%;" />

##### 虚连接

<font color=#FF0000>虚连接是在两台ABR之间，通过一个非骨干区域内部路由的区域而建立的一条逻辑上的连接通道。 它的两端必须都是ABR，并且必须在两端同时配 置。虚链接由对端路由器的Router ID来标识。为 虚连接提供非骨干区域内部路由的区域称为运输区域(Transit Area)。虚连接的配置是在 Transit 区域进行的。</font>

> 名词解释

 <img src="复习笔记.assets/截屏2021-11-21 下午7.48.40.png" alt="截屏2021-11-21 下午7.48.40" style="zoom:50%;" />

路由聚合：<font color=red>AS被划分成不同的区域，每一个区域通过OSPF 边界路由器(ABR)相连，区域间可以通过路由汇聚来减少路由信息，减小路由表的规模，提高路由器的运算速度。ABR在计算出 一个区域的区域内路由之后，查询路由表，将其中每一条OSPF路由封装成一条LSA发送到区域之外</font>。

> 简答题，什么是路由聚合

聚合示意图：

 <img src="复习笔记.assets/截屏2021-11-22 下午9.34.49.png" alt="截屏2021-11-22 下午9.34.49" style="zoom:20%;" />

Area 19 内有三条区域内路由19.1.1.0/24，19.1.2.0/24， 19.1.3.0/24，如果此时配置了路由聚合，将三条路由聚合成一条19.1.0.0/16，在RTA上就只生成一条描述聚合后路由的LSA

### SNMP

<font color=#FF0000>Simple Network Management Protocol，简单网络管理协议</font>（SNMP的名词解释，不确定下面蓝色的内容是否属于名词解释）

<font color=#0000FF>它的目标是保证管理信息在任意两点间传送，便于网络 管理员在网络上的任何节点检索信息，对信息进行修改， 寻找故障，完成故障诊断、容量规划和报告的生成。它 采用轮询机制，提供最基本的功能集，适合于小型、快 速和低价格的环境使用。</font>



# 实验

### 连接交换机到终端

1. 连线，如图

    <img src="复习笔记.assets/截屏2021-11-20 下午9.20.36.png" alt="截屏2021-11-20 下午9.20.36" style="zoom:50%;" />

2. 配置连接

 <img src="复习笔记.assets/截屏2021-11-20 下午9.21.07.png" alt="截屏2021-11-20 下午9.21.07" style="zoom:30%;" /><img src="复习笔记.assets/截屏2021-11-20 下午9.21.30.png" alt="截屏2021-11-20 下午9.21.30" style="zoom:30%;" /><img src="复习笔记.assets/截屏2021-11-20 下午9.22.04.png" alt="截屏2021-11-20 下午9.22.04" style="zoom:33%;" />

连接时使用COM1串口，参数设置为：<font color=#FF0000>设置波特率(每秒位数)为 9600bit/s</font>，数据位为 8， 奇偶校验为无，停止位为 1，数据流控制为无。

 <img src="复习笔记.assets/截屏2021-11-20 下午9.23.58.png" alt="截屏2021-11-20 下午9.23.58" style="zoom:33%;" />

### H3C 5024交换机面板

#### 前面板

<img src="复习笔记.assets/截屏2021-11-20 下午9.31.48.png" alt="截屏2021-11-20 下午9.31.48" style="zoom:30%;" />

 <img src="复习笔记.assets/截屏2021-11-20 下午11.02.13.png" alt="截屏2021-11-20 下午11.02.13" style="zoom:50%;" />

#### 接口指示灯的状态

端口指示灯分为黄色和绿色两种。 

<font color=red>当端口指示灯呈黄色时，表示端口工作在10/100Mbps速率下; 当端口指示灯呈绿色时，表示端口工作在1000Mbps速率下。 </font>

<font color=#FF0000>端口指示灯亮表示端口与对端设备有连接且连接正常; </font>

<font color=red>端口指示灯不亮则表示端口与对端设备无连接或端口连接失败; </font>

<font color=#FF0000>端口指示灯闪烁则表示端口在收发数据。</font>

### 在线命令行帮助

|             命令             |                             作用                             |
| :--------------------------: | :----------------------------------------------------------: |
|        \<Quidway> ？         |              查询该视图下所有的命令及其简单描述              |
|     \<Quidway>display  ?     | 键入一命令，后接以空格分隔的“?”，如果该位置为关键字，则列出全部关键字及其简单描 述。 |
|      \<Quidway>debugg?       | <font color=#FF0000>键入一字符串，其后紧接<?>，列出以该字符串开头的所有命令</font> |
|     \<Quidway>display u?     | 键入一命令，后接一字符串紧接<?>，列出命令以该字符串开头的所有关键字 |
| \<Quidway>disp ←按下\<Tab>键 | 键入命令的某个关键字的前几个字母，按下\<Tab>键，如果以输入字母开头的关键字唯一，则 可以显示出完整的关键字。 |

 <img src="复习笔记.assets/截屏2021-11-21 下午9.26.21.png" alt="截屏2021-11-21 下午9.26.21" style="zoom:50%;" />

### 交换机命令行常见错误信息

<font color=red>下表整个表考过填空，给左边，写出右边文字部分</font>

 <img src="复习笔记.assets/截屏2021-11-22 下午8.49.17.png" alt="截屏2021-11-22 下午8.49.17" style="zoom:50%;" />

### 交换机基础命令

凡是\<>或[]中的内容，均不是命令本身，只是现在所处的视图：

- 用户视图\<Quidway>
- 系统视图[Quidway]：在用户视图 下使用system-view命令即可进入系统视图
- 以太网端口视图[Quidway- GigabitEthernet0/1]：在系统视图下使用interface GigabitEthernet0/1命令即可进入以太网端口视图
- VLAN视图[Quidway-Vlan1]：在系统视图或以太网端口视图下使用vlan 1命令即可进入VLAN视图
- VLAN接口视图[Quidway- vlan-interface1]：在系统视图、以太网端口视图或VLAN 视图下使用interface vlan-interface1命令即可进入VLAN 接口视图，在此视图下配置VLAN对应的IP接口参数;

一些基础命令：

- 进入系统视图  \<Quidway> system-view

- <font color=red>更改交换机名字命令 [Quidway] sysname switch1</font>

- 恢复出厂设置 [Quidway] restore default
- 重起 \<Quidway> reboot
- 显示MAC地址表 [Quidway] dis mac-address
- 显示当前配置信息 [Quidway] display current-configuration
- 显示已经保存的配置 [Quidway] display saved-configuration
- 在用户视图下键入quit命令可以断开与交换机的连接。在 其它视图中键入quit命令可以退回到前一级视图。
- 键入return命令或使用快捷键<Ctrl+Z>可以直接退回到用 户视图。
- 显示系统版本信息 display version 

使用上光标键“↑”，可以访问上一条历史命令;

使用下光标键“↓”，可以访问下一条历史命令;

H3C S5000P命令行接口为每个用 户最多可以保存10条历史命令。

### 使用Telnet配置交换机

#### 前提条件

##### 配置交换机管理IP地址

 <img src="复习笔记.assets/截屏2021-11-22 上午10.17.27.png" alt="截屏2021-11-22 上午10.17.27" style="zoom:17%;" />

##### 配置Telnet登陆密码

 <img src="复习笔记.assets/截屏2021-11-22 上午10.17.56.png" alt="截屏2021-11-22 上午10.17.56" style="zoom:17%;" />

<font color=red>使用 Telnet 方式访问交换机的前提条件是什么？该前提条件的具体工作包括哪些？</font>（来源于2010级A卷简答第一题，答案为奔腾上的答案，感觉根据上面的内容自己总结也问题不大）

答：使用 Telnet 方式访问交换机的前提条件是首先必须对交换机进行初始化配置，否则用户无法正确登录和访问。初始化配置是为交换机配置正确的网段和 IP 地址，以便实现计算机和交换机互联。初始化配置需要使用 Console 口进行。它的工作包括：

(1)配置正确的交换机IP地址，这里所说的为交换机配置IP地址，实际上是指在交换机上配置管理 VLAN 接口的IP 地址。

(2)确定与PC 相连的交换机端口属于该管理 VLAN。

(3)如果 PC 和交换机相连的端口在同一局域网内，则其IP地址必须配置在同一网段;否则，要保证 PC 和交换机必须路由可达。

#### 使用Telnet配置

 <img src="复习笔记.assets/截屏2021-11-22 上午10.20.55.png" alt="截屏2021-11-22 上午10.20.55" style="zoom:25%;" />

注意：

- Console口访问方式和Telnet访问方式不能同时使用。当使用Telnet方式登录交换机时，出现“Console is busy, please try again later!” 的提示，表示已有用户通过Console口登录到以太网交换机。
- 不要使用Telnet方式修改交换机的管理IP 地址，这样会导致Telnet连接断开。

 <img src="复习笔记.assets/截屏2021-11-22 下午5.07.34.png" alt="截屏2021-11-22 下午5.07.34" style="zoom:50%;" />

> 答案为B，答案来源于[网络](https://wenku.baidu.com/view/3662142a3169a4517723a33b.html)



### 路由器在命令行接口下的配置命令

<font color=red>以下命令为ppt上比较集中在一起的；和2006年考到给操作含义让写命令的，这种用红色标出</font>

|                             操作                             |             命令              |
| :----------------------------------------------------------: | :---------------------------: |
|           <font color=red>显示当前配置信息</font>            | display current-configuration |
|          <font color=red>还原路由器默认设置</font>           |      reset saved；reboot      |
|          <font color=red>设置用户界面的级别</font>           | user privilege level *level*  |
|            <font color=red>关闭并重启接口</font>             |            restart            |
|     <font color=red>设置同/异步串口工作在同步方式</font>     |      physical-mode sync       |
|           <font color=red>删除全部静态路由</font>            |   delete static-routes all    |
|          <font color=red>禁止接口接收RIP报文</font>          |        undo rip input         |
|      <font color=red>在10.0.0.1/24接口上使能OSPF</font>      |  network 10.0.0.1 0.0.0.255   |
|                  允许接口向外发送RIP报文。                   |          rip output           |
| 在RIP 协议中引入其它协议的路由，缺省情况下，RIP 不引入其它路由。 |         import-route          |
|  启动RIP协议的运行并进入其视图,缺省情况下系统不运行RIP协议   |              rip              |
|                  在指定的网络接口上应用RIP                   |    network network-address    |
|                       显示保存配置信息                       |      saved-configuration      |
|                    显示当前视图的运行配置                    |         display this          |



### 路由器用户管理配置

 <img src="复习笔记.assets/截屏2021-11-22 下午5.01.53.png" alt="截屏2021-11-22 下午5.01.53" style="zoom:50%;" />

> 答案为D，答案来源于[网络](https://wenku.baidu.com/view/3662142a3169a4517723a33b.html)

#### 设置用户的优先级

**level *level***  （如 level 3）

#### 设置认证方案

**authentication-mode { password | scheme [ command- authorization | domain** **domain-name** **] }**

password:设置进行本地密码认证方式，即只需口令，不需用户名;

scheme:设置进行AAA授权认证方式，包括本地认证方案和RADIUS、HWTACACS认证，具体认证方案由scheme命令来指定;

command-authorization:设置命令行授权，HWTACACS协议支持对每条命令进行授权，授权通过，执行用户操作，否则拒绝执行;

domain domain-name:设置应用的AAA域的域名，长度为1~24 个字 符的字符串。如果VTY或者Console口下配置了domain domain-name， 则所有通过VTY或者Console口登录的用户都会使用所配置的domain 进 行AAA 认证、授权和计费，默认域以及登录过程中输入的用户名中携 带的域名信息都不再起作用。该domain的配置是可选配置，在没有此 domain配置的情况下，对原有版本admin接入用户的登录没做任何改变。

##### password认证

 <img src="复习笔记.assets/截屏2021-11-21 下午9.40.44.png" alt="截屏2021-11-21 下午9.40.44" style="zoom:20%;" />

##### <font color=#FF0000>AAA认证</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午9.42.30.png" alt="截屏2021-11-21 下午9.42.30" style="zoom:20%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午9.55.50.png" alt="截屏2021-11-21 下午9.55.50" style="zoom:50%;" />

> 2008级A卷选择第十题，答案是D，不知道为什么是D，只知道C是错的，3对应管理级别；个人的理解：域名设置是domain命令，即域名为system，而scheme local指的是一种具体的认证方案，故B错。**service-type** { **lan-access** | { **ssh** | **telnet** | **terminal** }*
>  [ **level** *level* ] }该命令用于设置服务类型，缺省情况下系统不授权任何服务。而参考：H3C S9500系列路由交换机总体手册1409页1424页



### 静态路由配置

#### 配置命令

 <img src="复习笔记.assets/截屏2021-11-21 上午11.56.41.png" alt="截屏2021-11-21 上午11.56.41" style="zoom:20%;" />

> 简单来说就是 ip route-static 要去的ip 他的子网掩码 下一步去哪个路由器（具体到哪个口）

#### 举例

 <img src="复习笔记.assets/截屏2021-11-21 下午12.00.27.png" alt="截屏2021-11-21 下午12.00.27" style="zoom: 25%;" />

RouterA：

 <img src="复习笔记.assets/截屏2021-11-21 下午12.01.25.png" alt="截屏2021-11-21 下午12.01.25" style="zoom:33%;" />

RouterB：

 <img src="复习笔记.assets/截屏2021-11-21 下午12.02.31.png" alt="截屏2021-11-21 下午12.02.31" style="zoom:25%;" />

RouterC：

 <img src="复习笔记.assets/截屏2021-11-21 下午12.03.07.png" alt="截屏2021-11-21 下午12.03.07" style="zoom:25%;" />

 <img src="复习笔记.assets/截屏2021-11-21 下午12.12.55.png" alt="截屏2021-11-21 下午12.12.55" style="zoom:40%;" />

(选C)

<font color=#FF0000>缺省路由</font>

 <img src="复习笔记.assets/截屏2021-11-21 下午9.02.25.png" alt="截屏2021-11-21 下午9.02.25" style="zoom:50%;" />

### <font color=red>纯交换机实验</font>

#### 2008级A卷第四题

下图为网络连接拓扑图，交换机switch1和switch2的Vlan划分相同，端口1-9属于Vlan1，端口10-19属于Vlan2，端口20-24属于Vlan3.

简述如何使用两种不同的方法实现PC1与PC3、PC2与PC4的连通。（不能改变主机所属Vlan，可以增加连线）

 <img src="复习笔记.assets/截屏2021-11-22 下午10.50.42.png" alt="截屏2021-11-22 下午10.50.42" style="zoom:20%;" />

方法1:增加两条连线，分别将两个交换机的Vlan2和Vlan3连接起来，实现同一Vlan下的主机相互连通。具体做法可以一条连线连接两台交换机的端口11，另一条连线连接两台交换机的端口21.

方法2:把端口1的类型设置为Trunk，并且允许Vlan2和Vlan3的数据通过该端口，这样能够实现PC1与PC3、PC2与PC4的连通

注：本题只需上面答案即可，下面补充方法2的具体命令：

```shell
system-view
interface GigabitEthernet 1
port link-type trunk
port trunk permit vlan 2 3
```

#### 2009级期末B第五题

网络设计。某单位要组建一个局域网网络，可以利用的网络设备包括 1 台 H3C 的 5024P交换机。该单位有 A、B、C三个部门，A、B部门各有8台计算机，c部门有7台计算机，组网要求 A、B、C三个部门各自要有独立的子网，3个部门都可以访问一台 FTP 服务器，其地址为 192.168.1.100。

1. 为各部门计算机分配IP地址

   答案：

   （地址分配可以有多种方案，只要合理即可以下是一种方法）

   A部门：192.168.1.1(255.255.255.0)-192.168.1.8(255.255.255.0)

   B部门：192.168.1.11(255.255.255.0)-192.168.1.18(255.255.255.0）

   C部门：192.168.1.21(255.255.255.0)-192.168.1.28(255.255.255.0)

2. 画出网络的拓扑图，并说明各设备通过哪些端口连接。

    <img src="复习笔记.assets/截屏2021-11-23 上午3.02.56.png" alt="截屏2021-11-23 上午3.02.56" style="zoom:30%;" />

   如图：交换机上划分3个用户组，usergroup1 包括端口 1到端口 8，用来连接A 部门的8台计算机，usergroup2 包括端口 9 到端口 16，用来连接B部门的8台计算机，usergroup3 包括端口17到端口23，用来连接C部门的7台计算机，24号端口属usergroup1,2,3，与 FTP 服务器相连接。

3. 说明交换机如何配置，并分别写出配置命令

   ```
   vlan1
   port g0/9 to port g0/16 user-group 2 将9-16添加到group2中 
   port g0/24 user-group 2    将24（服务器的端口）添加到group2中 
   port g0/17 to port g0/24 user-group 3 将17-24添加到group3中
   undo port g0/1 to port g0/23 user-group 1 见下面的解释
   ```

> 个人的理解：
>
> 1. 我认为采用Port-based VLAN是基于这样的事实：一 个端口可以属于多个user-group。不属于同一个user- group的端口不能相互通信。
> 2. 针对配置命令的最后一条，是由于执行undo port g0/1 to port g0/23 user-group 1  时：
>    1. 若端口不再属于任何user- group，系统会自动将此端口添加到user- group 1
>    2. 若端口只属于user group 1，那么不能将该端口从user group 1中 删除;
>    3. 若端口还属于其 他user group，那么可以将端口从user group 1中删除（Port-based VLAN的缺省状态为只有一个VLAN 1 存在，且所有端口只属于user-group 1。因此本质上就是把1-24端口中已经分配完组的端口从group1中移除）

#### 配置端口绑定（2011级A卷第五题）

以MAC地址00e0-fc01-0101绑定端口G0/1, 并且端口 GigabitEthernet0/1 属于 VLAN 1为例

```
sys
mac-address mac-learning GigabitEthernet0/1 disable  //取消G0/1的地址学习功能
mac-address static 00e0-fc01-0101 interface GigabitEthernet0/1 vlan 1   //添加一个静态 MAC 地址表项
```

#### 配置端口镜像（2011级A卷第五题）

例子：将 GigabitEthernet0/1 端口至 GigabitEthernet0/5 端口上的报文复制到指定镜像端口 GigabitEthernet0/10 上。

```
sys
monitor-port GigabitEthernet 0/10   //配置镜像端口
mirroring-port GigabitEthernet 0/1 to GigabitEthernet 0/5   //配置被镜像端口
```

>
>
>注意，2011级A卷没答案，我猜第五题需要端口绑定和端口镜像



### <font color=red>往年局域网实验（交换机+路由器）</font>

#### 2008级期末A

某单位要建立一个局域网网络，各个设备的地址设定与连接方法如拓扑图所示。其中，要求交换机 Switch2上的 G0/1 与G0/2 端口属于Vlan2， G0/3 与 G0/4 端口属于 Vlan3，路由器 Router1、Router2 及 Router3 要用动态路由协议进行管理，网络建立完后，要实现 PC1、PC2、PC3 之间的互相通信。

(1)简述要实现 PC1、PC2、PC3 之间的互相通信，各个设备需要如何进行配置。

(2)要完成以上网络规划，PCI、PC2、PC3 的默认网天地址分别是什么？

(3)要完成以上网络规划，交换机 Swith2 需要如何配置，写出配置步骤和配置命令。

(4)要完成以上网络规划，路由器 Routerl、 Router2 及 Router3 需要如何配置，写出配置步骤和配置命令。<img src="复习笔记.assets/截屏2021-11-22 下午11.19.02.png" alt="截屏2021-11-22 下午11.19.02" style="zoom:30%;" />

奔腾的答案：

(1)首先，**配置所有设备的网络接口的地址**，并把 PC1、 PC2、PC3 的**默认网关设置为相邻路由器相临接口的IP地址**；

​	在路由器 Router1、Router2 及 Router3 **启动RIP**动态路由协议，对RIP**使能所有网段**，并执行 Import Direct 命令**引入直连路由**；

​	在Switch2上**创建 Vlan2**，并分配端口 G0/1 和 G0/2，**创建 Vlan3**，并分配端口 G0/3 和G0/4。

(2) PC1、 PC2、PC3 的**默认网关设置为相邻路由器相临接口的IP地址**

 	PC1：192.168.1.254

 	PC2：192.168.2.254

 	PC3：192.168.3.254

(3)在Switch2上**创建 Vlan2**，并分配端口 G0/1 和 G0/2，**创建 Vlan3**，并分配端口 G0/3 和G0/4。

```
sys
vlan2
port g0/1 to g0/2
quit
vlan3
port g0/3 to g0/4
```

(4) 在路由器 Router1、Router2 及 Router3 **启动RIP**动态路由协议，对RIP**使能所有网段**，并执行 Import Direct 命令**引入直连路由**

Router1

```
sys
interface e0/1       //进入以太网口视图
ip address 192.168.1.254 255.255.255.0    //对各个以太网端口和串口设置ip和子网掩码
quit
interface s1/0       //进入串口视图
ip address 192.168.23.1 255.255.255.0
quit
interface s1/1
ip address 192.168.13.1 255.255.255.0
quit
rip
network 0.0.0.0  //所有网段rip使能
import direct    //引入直连路由
```

Router2

```
sys
interface e0/1
ip address 192.168.2.254 255.255.255.0
quit
interface s1/0
ip address 192.168.23.2 255.255.255.0
quit
rip
network 0.0.0.0
import direct
```

Router3

```
sys
interface e0/1
ip address 192.168.3.254 255.255.255.0
quit
interface s1/0
ip address 192.168.13.2 255.255.255.0
quit
rip
network 0.0.0.0
import direct
```

注：本题和上课的RIP实验图基本一致，多了一个PC，可以参考

#### 2009级期末A第四题

现有如下进行了部分配置的网络。路由器 Router1 和 Router2 通过串行线路相连，Router2连接到上级网络，各设备按如下拓扑图连线，并配置了如图所示的IP 地址和子网掩码。其中，Switch1、Switch2、Switch3 配置相同，G0/1、G0/2 属于 Vlan 2，G0/11、G0/12 属于 Vlan3，其余端口属于 Vlan 1，PC1 的默认网关为10.0.1.111，PC5 的默认网关为 10.0.3.111， PC6 的默认网关为 10.0.4.111, PC2、PC3、PC4未设置默认网关；为 Router1 配置缺省路由下一跳地址为10.0.0.2（发送端口S1/0）。请按要求分别完成下面2个问题。

 <img src="复习笔记.assets/截屏2021-11-23 上午1.44.14.png" alt="截屏2021-11-23 上午1.44.14" style="zoom:40%;" />

1. 使用 Ping 命令测试网络的连通性，判桥下面测试是否连通，并说明原因：（12分)

   1. PC1 上执行ping 10.0.2.1命令是否连通：
   2. PC1 上执行ping 10.0.1.2 命令是否连通；
   3. PC1 上执行 Ping 10.0.0.2 命令是否连通；
   4. PC5 上执行 Ping 10.0.4.1 命令是否连通;
   5. PC5 上执行 Ping 10.0.0.1 命令是否连通;
   6. PC5 上执行 Ping 10.0.1.1 命令是否连通.

   答案：

   1. 不通，属于不同局域网，但由于 Vlan 隔离导致无连通路径
   2. 不通，属于不同交换机同一Vlan，但 Vlan2无连通路径
   3. 不同，Ping数据包可通过端口 S1/0到达路由器 Router2，但 Ping 回应包在路由器 Router2处无法路由发送
   4. 连通，属于直连路由范围，可通过路由器连通
   5. 连通，由于Router1配置了缺省路由，可以连通
   6. 不通，由于 Router2 缺少到10.0.1.0网络的路由信息

   > 由于ping还需要接收数据包，所以能不能通不仅要看能不能过去，也要看能不能回来

2. 在不改变现有各PC的IP地址及所属 Vlan 的情况下，配置相关设备，使 PC1、PC2、PC3、PC4、 PC5、PC6 之间都能相互连通，必须采用动态路由协议 RIP，且Router2 只接收从上级网络发来的路由信息，但不对外发布内部网络的路由信息，请给出配置方案及各设备的配置命令（最多只能增加一条连按线路)。

   答案：

   采用动态路由协议 RIP 进行配置。增加一条连线，连接Router1的 E0/1 端口和 Switch1的G0/11 端口，配置 E0/1 端口IP地址为10.0.2.111/24，分别配置 PC2 和PC4 的默认网关为10.0.2.111//24， PC3 的默认网关为10.0.1.111//24。

   > 添加Router1的 E0/1 端口和 Switch1的G0/11 端口的连线，是因为G0/11和G0/12同属于Vlan3

   Switch1

   ```
   sys
   interface GigabitEthernet0/21
   port link-type trunk
   port trunk permit vlan 2 3   //设置21端口为trunk口，使得vlan2 3 的数据能够通过trunk口进行通信
   ```

   Switch2

   ```
   sys
   interface GigabitEthernet0/21
   port link-type trunk
   port trunk permit vlan 2 3   //设置21端口为trunk口，使得vlan2 3 的数据能够通过trunk口进行通信
   ```

   Router1

   ```
   sys
   interface e0/1
   ip address 10.0.2.111 255.255.255.0
   quit
   rip
   network 0.0.0.0   //所有端使能rip
   import direct     //引入直连路由
   ```

   Router2

   ```
   sys
   rip
   network 0.0.0.0
   import direct
   interface s1/1
   undo rip output   //禁止接口向外发送RIP报文
   rip input      //允许接口接收RIP报文
   
   ```

3. 在不改变现有各PC的IP地址及所属 Vlan 的情况下，配置相关设备，使 PC1、PC2、PC3、PC4、 PC5、PC6 之间都能相互连通，必须采用动态路由协议 OSPF，请给出配置方案及各设备的配置命令（最多只能增加一条连按线路)。

   答案：

   采用动态路由协议 OSPF 进行配置。增加一条连线，连接 Router1 的 E0/1 端口和 Switch1 的G0/11 端口，配置 E0/1 端口IP地址为 10.0.2.111/24，分别配置 PC2 和 PC4 的默认网关为10.0.2.111/24， PC3的默认网关为 10.0.1.111/24。

   Switch1

   ```
   sys
   interface GigabitEthernet0/21
   port link-type trunk
   port trunk permit vlan 2 3   //设置21端口为trunk口，使得vlan2 3 的数据能够通过trunk口进行通信
   ```

   Switch2

   ```
   sys
   interface GigabitEthernet0/21
   port link-type trunk
   port trunk permit vlan 2 3   //设置21端口为trunk口，使得vlan2 3 的数据能够通过trunk口进行通信
   ```

   Router1

   ```
   sys
   interface e0/1
   ip address 10.0.2.111 255.255.255.0  //设置新增连线端口的IP设置
   quit
   ospf
   area0  //进入区域0
   network 10.0.0.1 0.0.0.255  //指定网段使能OSPF协议 0.0.0.255是掩码取反，也可输入掩码，系统自动取反
   network 10.0.1.111 0.0.0.255
   network 10.0.2.111 0.0.0.255  //新增连线端口的配置
   import direct     //引入直连路由
   ```

   Router2

   ```
   sys
   ospf
   area0  
   network 10.0.0.2 0.0.0.255   
   network 10.0.3.111 0.0.0.255
   network 10.0.4.111 0.0.0.255  
   network 192.168.0.254 0.0.0.255  
   import direct     
   ```

> 第3问是该年B卷的第二问，将rip改成了ospf。这题我的看法是：
>
> 1. 如果通过交换机能ping通的，先设置交换机，看相对应的vlan是否有连线，没有对应的连线可以设置trunk口
> 2. 对称性比较强，在添加连线或设置IP时可以参考网络的其他部分
> 3. 要同时考虑能否发送到目的ip和能否从目的ip接收到
> 4. 要时刻记住vlan之间的隔离性（所以才有了添加的那条线）

#### 2009级期末A第五题

网络设计。某单位要组建一个局域网网络，可以利用的网络设备包括 1 台H3C的 AR-28路由器和2 台 H3C 的 5024P 交换机。该单位有 A、B、C三个部门，A、B部门各有15台计算机，C部门有14 台计算机，组网要求 A、B、C三个部门各自要有独立的子网，A 部门不与其它部门通信，B部门和C 部门可通过路由器相互通信。

1. 为路由器和各部门计算机分配IP地址，并说明各部门计算机的默认网关如何设置（5分)

   答案：

   地址分配可以有多种方案，只要合理即可，以下是一种方法）

   A部门：192.168.1.1(255.255.255.0)-192.168.1.15(255.255.255.0)

   B部门：192.168.2.1(255.255.255.0)-192.168.2.15(255.255.255.0

   C部门：192.168.3.1(255.255.255.0)-192.168.3.15(255.255.255.0）

   路由器：E0/0: 192.168.2.254(255.255.255.0）

   ​				E0/1: 192.168.3.254(255.255.255.0)

2. 画出网络的拓扑图，并说明各个设备通过哪些端口相互连接。（5分）

    <img src="复习笔记.assets/截屏2021-11-23 上午2.39.25.png" alt="截屏2021-11-23 上午2.39.25" style="zoom:30%;" />

   如图：

   交换机 1上划分 2个vlan,vlan1 包括端口 1到端口 15，用来连接A 部门的 15 台计算机;vlan2 包括端口 16 到端口 23，用来连接B部门的8台计算机，24 号端口设置为 Trunk 端口，用来连接交换机2。

   交换机2上划分2个vlan，vlan2 包括端口 1到端口8，1到7号端口用来连接B 部门的7台计算机，端口8与路由器的 E0/0 相连接，vlan1包括端口9到端口 23，9号端口与路由器的 E0/1 相连接，10到23 号端口用来连接C 部门的 14 台计算机，24 号端口设置
   为 Trunk 端口，与交换机1的24 号端口相连接。

3. 说明2台交换机如何配置，并分别写出配置命令。（5分)

   Switch1

   ```
   vlan2
   port 16 to port 23
   int g0/24
   port link-type trunk
   trunk permit vlan2
   ```

   Switch2

   ```
   vlan2
   port 1 to port 8
   int g0/24
   port link-type trunk
   trunk permit vlan2
   ```

   

4. 说明路由器如何配置，并写出配置命令。（5分）

   Router

   ```
   int e0/0
   ip address 192.168.2.254
   int e0/1
   ip address 192.168.3.254
   ```

> 个人的理解：
>
> 1. 由于每组的PC数量都大于12（交换机端口数的一半），因此必然不可能简单地将一组的所有主机通过一个交换机互联。答案的设计中，A、C组各自均通过一个交换机互联，不必进行额外的配置。而B组分成两部分，假设编号为0-13，0-6通过Switch1互联，7-13通过Switch2互联，两部分均设为vlan2，与其他组隔离，两台交换机上的vlan2通过一个Trunk口（即24号端口）连接。
> 2. 这种设计下，所以的路由均是直连路由，因此不必设置路由协议，配置ip即可

#### 配置RouterID(2011级A卷第四题)

**router id** *router-id*

*router-id*:路由器ID 号，点分十进制形式，如2.2.2.2。

#### 交换机VLAN和路由器子接口配置实验（2010级A卷）

只有答案没有题，但是看答案应该是一个路由子接口实验，因此找了ppt上的实验，好像是同一个

下图中，如何实现：

- 路由器子接口E0/0.1 、E0/0.2 和E0/1.1 、E0/1.2 的地址分别为1.0.0.1、2.0.0.1、3.0.0.1 和
  4.0.0.1;
- 工作站A 和B 之间、C 和D 之间能够互相通信，即同一交换机、不同VLAN之间能够互相通信; 
- 工作站A 和C 之间、B 和D 之间能够互相通信，即不同交换机、同一VLAN之间能够互相通信; 
- 工作站A 和D 之间、B 和C 之间能够互相通信，即不同交换机、不同VLAN之间能够互相通信

 <img src="复习笔记.assets/截屏2021-11-23 上午3.49.57.png" alt="截屏2021-11-23 上午3.49.57" style="zoom:30%;" />

Router

```
<H3C> system-view
[H3C] interface ethernet 0/0.1 
[H3C-Ethernet3/0/0.1] ip address 1.0.0.1 255.0.0.0
[H3C-Ethernet0/0.1] vlan-type dot1q vid 10 
[H3C-Ethernet0/0.1] interface ethernet 0/0.2 
[H3C-Ethernet0/0.2] ip address 2.0.0.1 255.0.0.0 
[H3C-Ethernet0/0.2] vlan-type dot1q vid 20

[H3C-Ethernet0/0.2] interface ethernet 0/1.1 
[H3C-Ethernet0/1.1] ip address 3.0.0.1 255.0.0.0 
[H3C-Ethernet0/1.1] vlan-type dot1q vid 10 
[H3C-Ethernet0/1.1] interface ethernet 0/1.2 
[H3C-Ethernet0/1.2] ip address 4.0.0.1 255.0.0.0 
[H3C-Ethernet0/1.2] vlan-type dot1q vid 20 
[H3C-Ethernet0/1.2] quit

```

Switch1 & 2：

  <img src="复习笔记.assets/截屏2021-11-23 上午3.57.40.png" alt="截屏2021-11-23 上午3.57.40" style="zoom:20%;" />

> 将Quidway换成H3C。名称问题，答案应该是粘贴串了

因为都是直连路由，因此路由器不需要设置路由

对于交换机，划分Vlan端口、设置Trunk

主机需要设置网关

#### 2008-2009学年（2006级）B卷第五题

和RIP实验类似，不做了，摆烂

#### 2006级实验部分

里面一些内容不知道到底讲过没有。。。。。。